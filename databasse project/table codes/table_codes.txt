DROP TABLE C##PROJECT_USER.USERS CASCADE CONSTRAINTS;

CREATE TABLE C##PROJECT_USER.USERS
(
  USER_ID          INTEGER                      NOT NULL,
  USERNAME         VARCHAR2(50 CHAR)            NOT NULL,
  EMAIL            VARCHAR2(50 CHAR)            NOT NULL,
  PASSWORD_HASH    VARCHAR2(255 CHAR)           NOT NULL,
  PROFILE_PICTURE  VARCHAR2(255 CHAR)           NOT NULL,
  CREATED_AT       TIMESTAMP(0),
  IS_ADMIN         INTEGER                      NOT NULL
)
TABLESPACE USERS
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE;


CREATE UNIQUE INDEX C##PROJECT_USER.USERS_PK ON C##PROJECT_USER.USERS
(USER_ID)
LOGGING
TABLESPACE USERS
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           );

ALTER TABLE C##PROJECT_USER.USERS ADD (
  CONSTRAINT USERS_PK
  PRIMARY KEY
  (USER_ID)
  USING INDEX C##PROJECT_USER.USERS_PK
  ENABLE VALIDATE);



DROP TABLE C##PROJECT_USER.CHANNELS CASCADE CONSTRAINTS;

CREATE TABLE C##PROJECT_USER.CHANNELS
(
  CHANNEL_ID    INTEGER                         NOT NULL,
  CHANNEL_NAME  VARCHAR2(100 CHAR)              NOT NULL,
  DESCRIPTION   CLOB
)
LOB (DESCRIPTION) STORE AS SECUREFILE (
  TABLESPACE  USERS
  ENABLE      STORAGE IN ROW
  CHUNK       8192
  RETENTION
  NOCACHE
  LOGGING)
TABLESPACE USERS
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE;


CREATE UNIQUE INDEX C##PROJECT_USER.CHANNELS_PK ON C##PROJECT_USER.CHANNELS
(CHANNEL_ID)
LOGGING
TABLESPACE USERS
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           );

ALTER TABLE C##PROJECT_USER.CHANNELS ADD (
  CONSTRAINT CHANNELS_PK
  PRIMARY KEY
  (CHANNEL_ID)
  USING INDEX C##PROJECT_USER.CHANNELS_PK
  ENABLE VALIDATE);




DROP TABLE C##PROJECT_USER.ENTRIES CASCADE CONSTRAINTS;

CREATE TABLE C##PROJECT_USER.ENTRIES
(
  ENTRY_ID    INTEGER                           NOT NULL,
  TITLE       VARCHAR2(50 CHAR)                 NOT NULL,
  CONTENT     CLOB                              NOT NULL,
  USER_ID     INTEGER                           NOT NULL,
  CHANNEL_ID  INTEGER                           NOT NULL,
  CREATED_AT  TIMESTAMP(0),
  UPDATED_AT  TIMESTAMP(0)
)
LOB (CONTENT) STORE AS SECUREFILE (
  TABLESPACE  USERS
  ENABLE      STORAGE IN ROW
  CHUNK       8192
  RETENTION
  NOCACHE
  LOGGING)
TABLESPACE USERS
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE;


CREATE UNIQUE INDEX C##PROJECT_USER.ENTRIES_PK ON C##PROJECT_USER.ENTRIES
(ENTRY_ID)
LOGGING
TABLESPACE USERS
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           );

ALTER TABLE C##PROJECT_USER.ENTRIES ADD (
  CONSTRAINT ENTRIES_PK
  PRIMARY KEY
  (ENTRY_ID)
  USING INDEX C##PROJECT_USER.ENTRIES_PK
  ENABLE VALIDATE);


ALTER TABLE C##PROJECT_USER.ENTRIES ADD (
  FOREIGN KEY (CHANNEL_ID) 
  REFERENCES C##PROJECT_USER.CHANNELS (CHANNEL_ID)
  ENABLE VALIDATE
,  FOREIGN KEY (USER_ID) 
  REFERENCES C##PROJECT_USER.USERS (USER_ID)
  ENABLE VALIDATE);



DROP TABLE C##PROJECT_USER.COMMENTS CASCADE CONSTRAINTS;

CREATE TABLE C##PROJECT_USER.COMMENTS
(
  COMMENT_ID  INTEGER                           NOT NULL,
  ENTRY_ID    INTEGER                           NOT NULL,
  USER_ID     INTEGER                           NOT NULL,
  CONTENT     CLOB,
  CREATED_AT  TIMESTAMP(0)
)
LOB (CONTENT) STORE AS SECUREFILE (
  TABLESPACE  USERS
  ENABLE      STORAGE IN ROW
  CHUNK       8192
  RETENTION
  NOCACHE
  LOGGING)
TABLESPACE USERS
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE;


CREATE UNIQUE INDEX C##PROJECT_USER.COMMENTS_PK ON C##PROJECT_USER.COMMENTS
(COMMENT_ID)
LOGGING
TABLESPACE USERS
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           );

ALTER TABLE C##PROJECT_USER.COMMENTS ADD (
  CONSTRAINT COMMENTS_PK
  PRIMARY KEY
  (COMMENT_ID)
  USING INDEX C##PROJECT_USER.COMMENTS_PK
  ENABLE VALIDATE);


ALTER TABLE C##PROJECT_USER.COMMENTS ADD (
  FOREIGN KEY (ENTRY_ID) 
  REFERENCES C##PROJECT_USER.ENTRIES (ENTRY_ID)
  ENABLE VALIDATE
,  FOREIGN KEY (USER_ID) 
  REFERENCES C##PROJECT_USER.USERS (USER_ID)
  ENABLE VALIDATE);


DROP TABLE C##PROJECT_USER.LIKES CASCADE CONSTRAINTS;

CREATE TABLE C##PROJECT_USER.LIKES
(
  LIKE_ID     INTEGER,
  ENTRY_ID    INTEGER,
  COMMENT_ID  INTEGER,
  USER_ID     INTEGER,
  CREATED_AT  TIMESTAMP(0)
)
TABLESPACE USERS
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE;


CREATE UNIQUE INDEX C##PROJECT_USER.LIKES_PK ON C##PROJECT_USER.LIKES
(LIKE_ID)
LOGGING
TABLESPACE USERS
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           );

ALTER TABLE C##PROJECT_USER.LIKES ADD (
  CONSTRAINT LIKES_PK
  PRIMARY KEY
  (LIKE_ID)
  USING INDEX C##PROJECT_USER.LIKES_PK
  ENABLE VALIDATE);


ALTER TABLE C##PROJECT_USER.LIKES ADD (
  FOREIGN KEY (ENTRY_ID) 
  REFERENCES C##PROJECT_USER.ENTRIES (ENTRY_ID)
  ENABLE VALIDATE
,  FOREIGN KEY (COMMENT_ID) 
  REFERENCES C##PROJECT_USER.COMMENTS (COMMENT_ID)
  ENABLE VALIDATE
,  FOREIGN KEY (USER_ID) 
  REFERENCES C##PROJECT_USER.USERS (USER_ID)
  ENABLE VALIDATE);


DROP TABLE C##PROJECT_USER.REPORTS CASCADE CONSTRAINTS;

CREATE TABLE C##PROJECT_USER.REPORTS
(
  REPORT_ID   INTEGER                           NOT NULL,
  USER_ID     INTEGER                           NOT NULL,
  ENTRY_ID    INTEGER                           NOT NULL,
  COMMENT_ID  INTEGER                           NOT NULL,
  REASON      CLOB,
  CREATED_AT  TIMESTAMP(0),
  STATUS      VARCHAR2(50 CHAR)
)
LOB (REASON) STORE AS SECUREFILE (
  TABLESPACE  USERS
  ENABLE      STORAGE IN ROW
  CHUNK       8192
  RETENTION
  NOCACHE
  LOGGING)
TABLESPACE USERS
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE;


CREATE UNIQUE INDEX C##PROJECT_USER.REPORTS_PK ON C##PROJECT_USER.REPORTS
(REPORT_ID)
LOGGING
TABLESPACE USERS
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           );

ALTER TABLE C##PROJECT_USER.REPORTS ADD (
  CONSTRAINT REPORTS_PK
  PRIMARY KEY
  (REPORT_ID)
  USING INDEX C##PROJECT_USER.REPORTS_PK
  ENABLE VALIDATE);


ALTER TABLE C##PROJECT_USER.REPORTS ADD (
  FOREIGN KEY (USER_ID) 
  REFERENCES C##PROJECT_USER.USERS (USER_ID)
  ENABLE VALIDATE
,  FOREIGN KEY (ENTRY_ID) 
  REFERENCES C##PROJECT_USER.ENTRIES (ENTRY_ID)
  ENABLE VALIDATE
,  FOREIGN KEY (COMMENT_ID) 
  REFERENCES C##PROJECT_USER.COMMENTS (COMMENT_ID)
  ENABLE VALIDATE);



DROP TABLE C##PROJECT_USER.SAVED_ENTRIES CASCADE CONSTRAINTS;

CREATE TABLE C##PROJECT_USER.SAVED_ENTRIES
(
  SAVED_ID  INTEGER                             NOT NULL,
  USER_ID   INTEGER                             NOT NULL,
  ENTRY_ID  INTEGER                             NOT NULL,
  SAVED_AT  TIMESTAMP(0)
)
TABLESPACE USERS
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE;


CREATE UNIQUE INDEX C##PROJECT_USER.SAVED_ENTRIES_PK ON C##PROJECT_USER.SAVED_ENTRIES
(SAVED_ID)
LOGGING
TABLESPACE USERS
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           );

ALTER TABLE C##PROJECT_USER.SAVED_ENTRIES ADD (
  CONSTRAINT SAVED_ENTRIES_PK
  PRIMARY KEY
  (SAVED_ID)
  USING INDEX C##PROJECT_USER.SAVED_ENTRIES_PK
  ENABLE VALIDATE);


ALTER TABLE C##PROJECT_USER.SAVED_ENTRIES ADD (
  FOREIGN KEY (USER_ID) 
  REFERENCES C##PROJECT_USER.USERS (USER_ID)
  ENABLE VALIDATE
,  FOREIGN KEY (ENTRY_ID) 
  REFERENCES C##PROJECT_USER.ENTRIES (ENTRY_ID)
  ENABLE VALIDATE);





DROP TABLE C##PROJECT_USER.MESSAGES CASCADE CONSTRAINTS;

CREATE TABLE C##PROJECT_USER.MESSAGES
(
  MESSAGE_ID   INTEGER                          NOT NULL,
  SENDER_ID    INTEGER                          NOT NULL,
  RECEIVER_ID  INTEGER                          NOT NULL,
  CONTENT      CLOB                             NOT NULL,
  SENT_AT      TIMESTAMP(0),
  IS_READ      INTEGER,
  IS_SENT      INTEGER,
  READED_AT    INTEGER
)
LOB (CONTENT) STORE AS SECUREFILE (
  TABLESPACE  USERS
  ENABLE      STORAGE IN ROW
  CHUNK       8192
  RETENTION
  NOCACHE
  LOGGING)
TABLESPACE USERS
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE;


CREATE UNIQUE INDEX C##PROJECT_USER.MESSAGES_PK ON C##PROJECT_USER.MESSAGES
(MESSAGE_ID)
LOGGING
TABLESPACE USERS
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           );

ALTER TABLE C##PROJECT_USER.MESSAGES ADD (
  CONSTRAINT MESSAGES_PK
  PRIMARY KEY
  (MESSAGE_ID)
  USING INDEX C##PROJECT_USER.MESSAGES_PK
  ENABLE VALIDATE);


ALTER TABLE C##PROJECT_USER.MESSAGES ADD (
  FOREIGN KEY (SENDER_ID) 
  REFERENCES C##PROJECT_USER.USERS (USER_ID)
  ENABLE VALIDATE
,  FOREIGN KEY (RECEIVER_ID) 
  REFERENCES C##PROJECT_USER.USERS (USER_ID)
  ENABLE VALIDATE);
